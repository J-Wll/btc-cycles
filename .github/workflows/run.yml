name: Update chart

on:
    workflow_dispatch:
    schedule:
        - cron: "0 3 * * *"

jobs:
    update_chart:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout repository
              uses: actions/checkout@v2

            - name: Set up python
              uses: actions/setup-python@v3
              with:
                  python-version: "3.10"
            
            - name: Install dependencies
              run: pip install -r requirements.txt

            - name: Run notebook
              run: jupyter nbconvert --to notebook --execute --inplace bitcoin.ipynb

            - name: Commit and push changes
              uses: giocaizzi/python-dev-actions/.github/actions/commit@main
              with:
                  message: "Update chart:${{ github.event.repository.updated_at}}"
                  github-token: ${{ secrets.GITHUB_TOKEN }}